---
title: "{{< fa database >}} ConnectomeDB2025: <span class='highlight'>Human LR Pairs</span>"
execute:
  echo: false
  warnings: false 
format:
  html:
    table: false
header-includes: |
  <script src="../js/keepDropdownMenuGold.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      // Check if the elements exist before changing text content
      const showAllButton = document.querySelector('.dtsp-showAll');
      const collapseAllButton = document.querySelector('.dtsp-collapseAll');
      const clearAllButton = document.querySelector('.dtsp-clearAll');
      const titleElement = document.querySelector('.dtsp-title');

      if (showAllButton) {
        showAllButton.textContent = "▼ Display All";
      }

      if (collapseAllButton) {
        collapseAllButton.textContent = "▲ Hide All";
      }

      if (clearAllButton) {
        clearAllButton.textContent = "⌫ Reset Filters";
      }
    });
  </script>
---

***

<!-- ## Species (if we have relaible evidence from PMID) | Ligand Symbol & Aliases | Receptor Symbol & Aliases are the three items than can be shown on top of the DB - no more than 1 line -->

```{=html}

<style>
/* Target the first search pane */
.dtsp-searchPane:first-child::before {
    content: "Database Source";
    font-weight: bold;
}

/* Target the second search pane */
.dtsp-searchPane:nth-child(2)::before {
    content: "Ligand Symbol and Aliases";
    font-weight: bold;
}

/* Target the third search pane */
.dtsp-searchPane:nth-child(3)::before {
    content: "Receptor Symbol and Aliases";
    font-weight: bold;
}

/* Target the fourth search pane */
.dtsp-searchPane:nth-child(4)::before {
    content: "Binding Location";
    font-weight: bold;
}

/* Target the fifth search pane */
.dtsp-searchPane:nth-child(5)::before {
    content: "Ligand Location";
    font-weight: bold;
}

/* Target the sixth search pane */
.dtsp-searchPane:nth-child(6)::before {
    content: "Receptor Location";
    font-weight: bold;
}

/* Target the seventh search pane */
.dtsp-searchPane:nth-child(7)::before {
    content: "KEGG Pathway";
    font-weight: bold;
}

/* Target the eight search pane */
.dtsp-searchPane:nth-child(8)::before {
    content: "Disease Type";
    font-weight: bold;
}

</style>

```


```{python}
import sys
import os
import pandas as pd
import warnings
from pandas.errors import SettingWithCopyWarning

# Suppress the SettingWithCopyWarning
warnings.simplefilter(action='ignore', category=SettingWithCopyWarning)
warnings.filterwarnings("ignore", category=pd.errors.DtypeWarning)
from itables import init_notebook_mode, show
from IPython.display import display, Javascript
import itables.options as opt
# Change working directory to ConnectomeDB
project_root = os.path.dirname(os.getcwd())
os.chdir(project_root)
sys.path.append(os.path.abspath("src"))
from createDataTable import gene_pair

human_gene_pair = gene_pair.iloc[:, :-28]

# Turn Interaction ID into clickable links
human_gene_pair[human_gene_pair.columns[0]] = human_gene_pair[human_gene_pair.columns[0]].apply(
    lambda x: f"<a href='https://comp.med.yokohama-cu.ac.jp/collab/connectomeDB/database/filter/{x}.html'>{x}</a>"
)

# Function to update and display the table
def update_table():
    show(
        human_gene_pair,
        keys=True,
        layout={"bottom": ["searchPanes"],
                "top": ["info", "paging"],
                },
        searchPanes={"layout": "rows-1", 
                     "cascadePanes": True, 
                     "columns": [2,18,19,7,13,14,15,17], 
                     "regex": True, "caseInsensitive": False, 
                     "smart": True, 
                     "initCollapsed": True, 
                     "controls": True},
        #layout={"bottom": "searchBuilder", "title": "Advanced Search"},
        fixedColumns={"start": 2, "end": 0},
        fixedHeader=True,  # Keep header fixed for alignment
        column_filters="footer", 
        scrollX=True,
        classes="display nowrap cell-border compact",
        select=True,
        selected_rows=[],
        responsive=True,  # Enable responsive behavior
        theme='grid',
        search={"regex": True, "caseInsensitive": True, "smart": False},
        lengthMenu=[ [10, 20, 50, 100, -1], ["10", "20", "50", "100", "All"] ],
        buttons=[
            "pageLength",  
            {"extend": "colvis", "text": "Display Columns"},
            {"extend": "csvHtml5", "title": "Source"},
            {"extend": "excelHtml5", "title": "Source"},
            {"extend": "copyHtml5", "title": "Source"},
        ],
        columnDefs=[
            {"className": "dt-center", "targets": [5]}, 
            {"search": False, "targets": [5]},
            # {"width": "100px", "targets": "_all"},
            {"visible": False, "targets": list(range(-1, -15, -1))} # Hide last 14 columns by default
        ],
        style="1200px;margin:auto",
           language={
            "search": "Search Gene of Interest:",
            "searchPlaceholder": "e.g. CD80",
            "searchPanesPlaceholder": "",
           # "searchBuilder": {
           #     "title": "Advanced Search <i>Multiple filtering, AND/OR condition</i>" 
           # }
        }, 
        autoWidth=True,
        maxBytes=0,  # So it does not downsample
        initCode='''
            $(document).on('draw.dt', function () {
                const table = $($.fn.dataTable.tables(true)).DataTable();
                const searchTerm = table.search().trim();

                table.rows().every(function () {
                    const data = this.data();
                    let isExactMatch = false;

                    for (let i = 0; i < data.length; i++) {
                        let cellText = $('<div>').html(data[i]).text().trim();
                        if (cellText === searchTerm) {
                            isExactMatch = true;
                            break;
                        }
                    }

                    $(this.node()).toggleClass('exact-match', isExactMatch);
                });

                const rows = table.rows({ page: 'current' }).nodes().to$();
                rows.sort(function (a, b) {
                    return $(b).hasClass('exact-match') - $(a).hasClass('exact-match');
                }).appendTo(table.table().body());
            });
        ''',

)

# Call the function to render the table
update_table()
```

{{< include hint.qmd >}}

### Advanced Search


