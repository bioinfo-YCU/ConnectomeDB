---
title: "Downloads"
---

```{python}
#| echo: false
#| output: asis

import os
import json
from pathlib import Path
from datetime import datetime
import humanize

def load_config():
    """Load repository configuration"""
    config_file = Path("JSON/config.json")
    if config_file.exists():
        with open(config_file, 'r') as f:
            return json.load(f)
    return {
        "title": "ConnectomeDB Current Data Repository",
        "description": "Browse and download Ligand-receptor database tables across 14 most studied species.",
        "license": "MIT License",
        "contact":  "mailto:&#104;&#101;&#108;&#112;&#64;&#99;&#111;&#110;&#110;&#101;&#99;&#116;&#111;&#109;&#101;&#100;&#98;&#46;&#111;&#114;&#103;,&#97;&#108;&#105;&#115;&#116;&#97;&#105;&#114;&#46;&#102;&#111;&#114;&#114;&#101;&#115;&#116;&#64;&#112;&#101;&#114;&#107;&#105;&#110;&#115;&#46;&#117;&#119;&#97;&#46;&#101;&#100;&#117;&#46;&#97;&#117;",
        "citation": "[ConnectomeDB2025, a high quality manually curated ligand-receptor database for cell-to-cell communication prediction](), P Liu, S Maezono et al. *Journal Title* **XX (YY)**, ZZZ (2025). DOI: 10.xxxx/xxxxx"
    }

def is_visible(p):
    """Check if a path is visible (not hidden). Only checks the immediate filename/dirname."""
    return not p.name.startswith('.')

def get_current_release_info(base_path="downloads"):
    """Get information about the Current-Release directory only."""
    base = Path(base_path)
    current_release_path = base / "Current-Release"
    
    if not current_release_path.exists():
        return None
    
    # Collect visible files recursively
    all_visible_files = []
    for subitem in current_release_path.rglob("*"):
        if subitem.is_file() and is_visible(subitem):
            all_visible_files.append(subitem)
    
    if all_visible_files:
        last_modified = max((f.stat().st_mtime for f in all_visible_files), default=0)
        last_modified_date = datetime.fromtimestamp(last_modified).strftime("%Y-%m-%d") if last_modified else "Unknown"
    else:
        last_modified_date = "Unknown"
    
    return {
        "name": "Current-Release",
        "last_modified": last_modified_date,
        "description": "[[CSV]](downloads/Current-Release/CSV/index.qmd)・[[Excel]](downloads/Current-Release/Excel/index.qmd)・[[JSON]](downloads/Current-Release/JSON/index.qmd)"
    }

# Load configuration and directory info
config = load_config()
current_release = get_current_release_info()

# Print the top-level Markdown content
print(f"""
## {config['title']}


All ConnectomeDB ligand–receptor interaction data are freely available under the MIT License and are provided AS IS, without any warranty. Please use the file navigator below to browse and download the most up-to-date database tables. For previous data releases, please click [here](previous_downloads.qmd).

---

### Available Datasets
""")

# Create DataFrame for table display
import pandas as pd

if current_release:
    df = pd.DataFrame([current_release])
    
    # Rename columns for display
    df.rename(columns={
        'name': 'Directory', 
        'last_modified': 'Release Date', 
        'description': 'Downloads'
    }, inplace=True)
    
    print(df.to_markdown(index=False))
else:
    print("| Directory | Release Date | Downloads |\n|-----------|--------------|-----------|")
    print("| Current-Release | Not Available | Not Available |")

print(f"""
---
If you have any questions, please feel free to [contact us]({config['contact']}). If you are using ConnectomeDB, please cite: {config['citation']}
""")


```